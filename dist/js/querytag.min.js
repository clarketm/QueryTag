/*!
 * QueryTag.js v1.0.2 (https://www.travismclarke.com)
 * Copyright 2018 Travis Clarke
 * Licensed under the MIT license
 */
!function(e,t){if("function"==typeof define&&define.amd)define(function(e){var r;try{r=e("jquery")}catch(a){}return t(r)});else if("object"==typeof exports&&"string"!=typeof exports.nodeName){var r;try{r=require("jquery")}catch(a){}module.exports=t(r)}else e.QueryTag=t(e.jQuery)}(this,function(e){"use strict";var t;e.fn.queryTag=function(a,n,o){var s,i=e.extend([],e.fn.queryTag.defaultViews,o),l=e.fn.queryTag.selectors,c=e.fn.queryTag.styles,u="https://cse.google.com/api/"+a+"/cse/"+n+"/queries/js",f=["overall","year","month","week","day"],d=[],p=e(l.$searchForm),h=e(l.$menuGroup),g=e(l.$buttonGroup),y=e(l.$selectGroup),m=e(l.$navIcon),v=e(l.$alertInfo),b=e(l.$alertEmpty),T=e(l.$alertError),q=c.button,w=c.category,j=c.color;switch(c.reload){case"img":s=e.fn.queryTag.reloadStyle.img.element();break;case"fontawesome":s=e.fn.queryTag.reloadStyle.fontawesome.element();break;case null:case!1:case void 0:case"":s="";break;default:s=c.reload}return b.html(function(t,r){return e.fn.queryTag.emptyText+r}),T.html(function(t,r){return e.fn.queryTag.errorText+s+r}),this.each(function(){function a(){e.ajax({dataType:"json",url:e.fn.queryTag.pathToJSON,data:e.fn.queryTag.data,success:function(e){n(new r(z,e,w,j))},error:function(e,t,r){console.group("There was a %s loading your category data",t),console.error("Error: ",r),console.groupEnd(),C()}})}function n(t){t.empty();var r={overall:e.ajax({url:u,jsonp:"callback",dataType:"jsonp",data:{view:f[0]},success:function(e){t.render(f[0],e)}}),year:e.ajax({url:u,jsonp:"callback",dataType:"jsonp",data:{view:"one_"+f[1]},success:function(e){t.render(f[1],e)}}),month:e.ajax({url:u,jsonp:"callback",dataType:"jsonp",data:{view:f[2]},success:function(e){t.render(f[2],e)}}),week:e.ajax({url:u,jsonp:"callback",dataType:"jsonp",data:{view:f[3]},success:function(e){t.render(f[3],e)}}),day:e.ajax({url:u,jsonp:"callback",dataType:"jsonp",data:{view:f[4]},success:function(e){t.render(f[4],e)}})};i.forEach(function(e){d.push(r[e])}),e.when.apply(e,d).then(function(){z.show(),o()},function(e,r,a){console.group("There was a %s fetching your query data from Google",r),console.error("Error: ",a),console.groupEnd(),C(t)})}function o(){var t=e(".label");t.each(function(){var t=e(this).attr("data-number");e(this).css("font-size",e.fn.queryTag.sizes[t])}),s()}function s(){t=z.isotope({itemSelector:".label",filter:".overall",layoutMode:"packery",getSortData:{name:".name",number:"[data-number]",category:"[data-category]"},vertical:{horizontalAlignment:0}}),l(),c(),k(),x(),$(),E()}function l(){y.on("change","select",function(){var t=e(this),r="."+t.val().toLowerCase();g.children("button").removeClass("active"),G("packery","original-order",r,t)})}function c(){z.on("click",".label",function(t){t.preventDefault();var r=e(this),a=r.find(".name").text(),n=p.find("#search").length?p.find("#search"):p.find("input[type='search']").first(),o=e.Event("query.qt");o.tag=a,o.input=n,o.form=p,r.trigger(o)})}function k(){t.on("layoutComplete",function(e,t){var r,a=t.length;v.removeClass("alert-success"),v.removeClass("alert-warning"),0===a?(g.children("button").prop("disabled",!0),v.addClass("alert-warning").html("0 results found"),b.slideDown(250)):(g.children("button").prop("disabled",!1),r=1===a?"result":"results",v.addClass("alert-success").html(a+" "+r+" found"))}),v.css("display","inline-block")}function x(){var t=[];g.children("button").addClass(q),g.on("click","button",function(r){var a=e(this),n=a.attr("data-sort-value");r.ctrlKey||r.metaKey?a.toggleClass("active"):(a.toggleClass("active"),g.children("button").not(a).removeClass("active"),t=[]);var o=g.children(".active"),s=o.length?"vertical":"packery";a.is(".active")?t.push(n):t.splice(t.indexOf(n),1),0===t.length&&t.push("original-order"),S(s,t,a)})}function $(){m.append('<div class="icon"></div>'),m.click(function(){var t=e(this),r=g.children("button").is(".active");t.toggleClass("open"),g.children("button").removeClass("active"),S("packery",["original-order"],t,r),h.slideToggle(350,function(){t.is(".open")?t.trigger("shown.qt"):t.trigger("hidden.qt")})})}function C(t){T.slideDown(),e("#refresh").on("click",function(){T.fadeOut(1400),e(this).children().rotate(720,{duration:1400,easing:"swing",complete:function(){t?n(t):a()}})})}function E(){t.isotope()}function S(r,a,n,o){return t.isotope({layoutMode:r,sortBy:a}),n.is(".navicon")?void(o&&n.trigger("unsort.qt")):void(e.inArray("original-order",a)?n.trigger("sort.qt"):n.trigger("unsort.qt"))}function G(r,a,n,o){b.hide(),t.isotope({layoutMode:r,sortBy:a,filter:n});var s=e.Event("filter.qt");s.view=o.val(),o.trigger(s)}var z=e(this);z.hide(),a()})},e.fn.queryTag.defaultViews=["overall","year","month","week","day"],e.fn.queryTag.selectors={$searchForm:".searchable",$menuGroup:".collapsible",$buttonGroup:".sortable",$selectGroup:".filterable",$navIcon:".navicon",$alertInfo:"#alert-results",$alertEmpty:"#alert-empty",$alertError:"#alert-error"},e.fn.queryTag.styles={category:"general",button:"button-default",color:"label-default",reload:"img"},e.fn.queryTag.sizes=["1.5em","1.375em","1.25em","1.125em","1em","0.9375em","0.875em"],e.fn.queryTag.pathToJSON="dist/data/categories.json",e.fn.queryTag.data=null,e.fn.queryTag.emptyText="Sorry, no results found for your search.",e.fn.queryTag.errorText="Sorry! We are unable to retrieve the search queries at this time.",e.fn.queryTag.reloadStyle={img:{src:"dist/img/refresh.png",element:function(){return"<a id='refresh' href='#'><img src="+this.src+" alt='refresh'></a>"}},fontawesome:{size:"fa-2x",element:function(){return"<a id='refresh' title='refresh' href='#'><i class='fa fa-refresh "+this.size+"'></i></a>"}}},e.fn.rotate=function(t,r,a,n){var o=e.speed(r,a,n),s=o.step;return this.each(function(r,a){o.complete=e.proxy(o.complete,a),o.step=function(t){if(e.style(a,"transform","rotate("+t+"deg)"),s)return s.apply(a,arguments)},e({deg:0}).animate({deg:t},o)})};var r=function(e,t,r,a){this.container=e,this.data=t,this.category=r,this.color=a,this.septiles=[];for(var n=1;n<=7;n++)this.septiles.push(100-100/7*n)};r.prototype.empty=function(){this.container.empty()},r.prototype.render=function(t,r){for(var a=r.popularQueries.length,n=0;n<a;n++){var o=e('<a href="#" class="label"><span class="name"></span></a>'),s=(a-(n+1)+.5)/a*100,i=r.popularQueries[n].query,l=this.category,c=this.color;e.each(this.septiles,function(e,t){if(s>t)return s=e,!1}),e.each(this.data,function(e,t){if("general"!=e)return t.list.indexOf(i)!==-1?(l=e,c=t.color,!1):void 0}),o.addClass(c),o.addClass(t),o.find(".name").text(i),o.attr("data-number",s),o.attr("data-category",l),this.container.append(o)}};var a=e.fn.queryTag;return a.QueryTag=a,a});