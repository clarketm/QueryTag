/*! * queryTag.js v1.0.0 (https://www.travismclarke.com) * Copyright 2015 Travis Clarke * Licensed under the MIT license */
!function(e,t){var r,a=e.jQuery;a.fn.queryTag=function(e,o,s){var i,l=a.extend([],a.fn.queryTag.defaultViews,s),c=a.fn.queryTag.selectors,u=a.fn.queryTag.styles,d="https://cse.google.com/api/"+e+"/cse/"+o+"/queries/js",f=["overall","year","month","week","day"],p=[],h=a(c.$searchForm),g=a(c.$menuGroup),y=a(c.$buttonGroup),m=a(c.$selectGroup),v=a(c.$navIcon),b=a(c.$alertInfo),T=a(c.$alertEmpty),q=a(c.$alertError),w=u.button,j=u.category,k=u.color;switch(u.reload){case"img":i=a.fn.queryTag.reloadStyle.img.element();break;case"fontawesome":i=a.fn.queryTag.reloadStyle.fontawesome.element();break;case null:case!1:case t:case"":i="";break;default:i=u.reload}return T.html(function(e,t){return a.fn.queryTag.emptyText+t}),q.html(function(e,t){return a.fn.queryTag.errorText+i+t}),this.each(function(){function e(){a.ajax({dataType:"json",url:a.fn.queryTag.pathToJSON,data:a.fn.queryTag.data,success:function(e){t(new n(z,e,j,k))},error:function(e,t,r){console.group("There was a %s loading your category data",t),console.error("Error: ",r),console.groupEnd(),C()}})}function t(e){e.empty();var t={overall:a.ajax({url:d,jsonp:"callback",dataType:"jsonp",data:{view:f[0]},success:function(t){e.render(f[0],t)}}),year:a.ajax({url:d,jsonp:"callback",dataType:"jsonp",data:{view:"one_"+f[1]},success:function(t){e.render(f[1],t)}}),month:a.ajax({url:d,jsonp:"callback",dataType:"jsonp",data:{view:f[2]},success:function(t){e.render(f[2],t)}}),week:a.ajax({url:d,jsonp:"callback",dataType:"jsonp",data:{view:f[3]},success:function(t){e.render(f[3],t)}}),day:a.ajax({url:d,jsonp:"callback",dataType:"jsonp",data:{view:f[4]},success:function(t){e.render(f[4],t)}})};l.forEach(function(e){p.push(t[e])}),a.when.apply(a,p).then(function(){z.show(),o()},function(t,r,a){console.group("There was a %s fetching your query data from Google",r),console.error("Error: ",a),console.groupEnd(),C(e)})}function o(){var e=a(".label");e.each(function(){var e=a(this).attr("data-number");a(this).css("font-size",a.fn.queryTag.sizes[e])}),s()}function s(){r=z.isotope({itemSelector:".label",filter:".overall",layoutMode:"packery",getSortData:{name:".name",number:"[data-number]",category:"[data-category]"},vertical:{horizontalAlignment:0}}),i(),c(),u(),x(),$(),E()}function i(){m.on("change","select",function(){var e=a(this),t="."+e.val().toLowerCase();y.children("button").removeClass("active"),G("packery","original-order",t,e)})}function c(){z.on("click",".label",function(e){e.preventDefault();var t=a(this),r=t.find(".name").text(),n=h.find("#search").length?h.find("#search"):h.find("input[type='search']").first(),o=a.Event("query.qt");o.tag=r,o.input=n,o.form=h,t.trigger(o)})}function u(){r.on("layoutComplete",function(e,t){var r,a=t.length;b.removeClass("alert-success"),b.removeClass("alert-warning"),0===a?(y.children("button").prop("disabled",!0),b.addClass("alert-warning").html("0 results found"),T.slideDown(250)):(y.children("button").prop("disabled",!1),r=1===a?"result":"results",b.addClass("alert-success").html(a+" "+r+" found"))}),b.css("display","inline-block")}function x(){var e=[];y.children("button").addClass(w),y.on("click","button",function(t){var r=a(this),n=r.attr("data-sort-value");t.ctrlKey||t.metaKey?r.toggleClass("active"):(r.toggleClass("active"),y.children("button").not(r).removeClass("active"),e=[]);var o=y.children(".active"),s=o.length?"vertical":"packery";r.is(".active")?e.push(n):e.splice(e.indexOf(n),1),0===e.length&&e.push("original-order"),S(s,e,r)})}function $(){v.append('<div class="icon"></div>'),v.click(function(){var e=a(this),t=y.children("button").is(".active");e.toggleClass("open"),y.children("button").removeClass("active"),S("packery",["original-order"],e,t),g.slideToggle(350,function(){e.is(".open")?e.trigger("shown.qt"):e.trigger("hidden.qt")})})}function C(r){q.slideDown(),a("#refresh").on("click",function(){q.fadeOut(1400),a(this).children().rotate(720,{duration:1400,easing:"swing",complete:function(){r?t(r):e()}})})}function E(){r.isotope()}function S(e,t,n,o){return r.isotope({layoutMode:e,sortBy:t}),n.is(".navicon")?void(o&&n.trigger("unsort.qt")):void(a.inArray("original-order",t)?n.trigger("sort.qt"):n.trigger("unsort.qt"))}function G(e,t,n,o){T.hide(),r.isotope({layoutMode:e,sortBy:t,filter:n});var s=a.Event("filter.qt");s.view=o.val(),o.trigger(s)}var z=a(this);z.hide(),e()})},a.fn.queryTag.defaultViews=["overall","year","month","week","day"],a.fn.queryTag.selectors={$searchForm:".searchable",$menuGroup:".collapsible",$buttonGroup:".sortable",$selectGroup:".filterable",$navIcon:".navicon",$alertInfo:"#alert-results",$alertEmpty:"#alert-empty",$alertError:"#alert-error"},a.fn.queryTag.styles={category:"general",button:"button-default",color:"label-default",reload:"img"},a.fn.queryTag.sizes=["1.5em","1.375em","1.25em","1.125em","1em","0.9375em","0.875em"],a.fn.queryTag.pathToJSON="dist/data/categories.json",a.fn.queryTag.data=null,a.fn.queryTag.emptyText="Sorry, no results found for your search.",a.fn.queryTag.errorText="Sorry! We are unable to retrieve the search queries at this time.",a.fn.queryTag.reloadStyle={img:{src:"dist/img/refresh.png",element:function(){return"<a id='refresh' href='#'><img src="+this.src+" alt='refresh'></a>"}},fontawesome:{size:"fa-2x",element:function(){return"<a id='refresh' title='refresh' href='#'><i class='fa fa-refresh "+this.size+"'></i></a>"}}},a.fn.rotate=function(e,t,r,n){var o=a.speed(t,r,n),s=o.step;return this.each(function(t,r){o.complete=a.proxy(o.complete,r),o.step=function(e){return a.style(r,"transform","rotate("+e+"deg)"),s?s.apply(r,arguments):void 0},a({deg:0}).animate({deg:e},o)})};var n=function(e,t,r,a){this.container=e,this.data=t,this.category=r,this.color=a,this.septiles=[];for(var n=1;7>=n;n++)this.septiles.push(100-100/7*n)};n.prototype.empty=function(){this.container.empty()},n.prototype.render=function(e,t){for(var r=t.popularQueries.length,n=0;r>n;n++){var o=a('<a href="#" class="label"><span class="name"></span></a>'),s=(r-(n+1)+.5)/r*100,i=t.popularQueries[n].query,l=this.category,c=this.color;a.each(this.septiles,function(e,t){return s>t?(s=e,!1):void 0}),a.each(this.data,function(e,t){return"general"!=e&&-1!==t.list.indexOf(i)?(l=e,c=t.color,!1):void 0}),o.addClass(c),o.addClass(e),o.find(".name").text(i),o.attr("data-number",s),o.attr("data-category",l),this.container.append(o)}}}(window);